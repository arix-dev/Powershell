<#	
	.NOTES
	===========================================================================
	 Created on:   	***
	 Created by:   	Andrew Rix
	 Organization: 	Rixworx Solutions Inc
	 Working OS:	Windows
	===========================================================================
	.DESCRIPTION
		Example of Windows Forms in Powershell
#>

Add-Type -AssemblyName System.Windows.Forms

function Show-BalloonTip
{
    param
    (
        [Parameter(Mandatory=$true)][string]$Text,
        [string]$Title = "GUI Test",
        [ValidateSet('Info','Warning','Error','None')][string]$Icon = 'Info'
    )

    Add-Type -AssemblyName  System.Windows.Forms

    # we use private variables only. No need for global scope
    $balloon = New-Object System.Windows.Forms.NotifyIcon 
    $cleanup = 
    {    
        # this gets executed when the user clicks the balloon tip dialog

        # take the balloon from the event arguments, and dispose it
        $event.Sender.Dispose()
        # take the event handler names also from the event arguments,
        # and clean up
        Unregister-Event  -SourceIdentifier $event.SourceIdentifier
        Remove-Job -Name $event.SourceIdentifier
        $name2 = "M" + $event.SourceIdentifier
        Unregister-Event  -SourceIdentifier $name2
        Remove-Job -Name $name2
    }
    $showBalloon = 
    {
        # this gets executed when the user clicks the tray icon
        $event.Sender.ShowBalloonTip(5000) 
    }

    # use unique names for event handlers so you can open multiple balloon tips
    $name = [Guid]::NewGuid().Guid

    # subscribe to the balloon events
    $null = Register-ObjectEvent -InputObject $balloon -EventName BalloonTipClicked -Source $name -Action $cleanup
    $null = Register-ObjectEvent -InputObject $balloon -EventName MouseClick -Source "M$name" -Action $showBalloon

    # use the current application icon as tray icon
    $path = (Get-Process -id $pid).Path
    $balloon.Icon  = [System.Drawing.Icon]::ExtractAssociatedIcon($path) 

    # configure the balloon tip
    $balloon.BalloonTipIcon  = $Icon
    $balloon.BalloonTipText  = $Text
    $balloon.BalloonTipTitle  = $Title

    # make the tray icon visible
    $balloon.Visible  = $true 
    # show the balloon tip
    $balloon.ShowBalloonTip(5000) 
}


# Get the Base64 string of an image from here https://www.base64-image.de/
$Base64Icon ='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jBUpe93j3T2dvf17ptXfD9vHctGOw8PNAAAN/WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNC40LjAtRXhpdjIiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iCiAgICB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIgogICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICAgeG1sbnM6R0lNUD0iaHR0cDovL3d3dy5naW1wLm9yZy94bXAvIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgIHhtcE1NOkRvY3VtZW50SUQ9ImdpbXA6ZG9jaWQ6Z2ltcDo4MWY4MzgzNy0xOGJmLTQwNjItYmNlMC04YzIzMDZmNGY0Y2QiCiAgIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NGU1MWZhNzktYzgxMy00ZGI1LWJlMzgtZGY2ZGJlOTA2ZmEyIgogICB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6NTE3MTk5ZWYtMDVmNC00MmU3LThmOTgtN2U4NDA5M2MzZWFiIgogICBkYzpGb3JtYXQ9ImltYWdlL3BuZyIKICAgR0lNUDpBUEk9IjIuMCIKICAgR0lNUDpQbGF0Zm9ybT0iTGludXgiCiAgIEdJTVA6VGltZVN0YW1wPSIxNjMyMjMyNTY1MTcyODg0IgogICBHSU1QOlZlcnNpb249IjIuMTAuMjYiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiCiAgIHhtcDpDcmVhdG9yVG9vbD0iR0lNUCAyLjEwIj4KICAgPHhtcE1NOkhpc3Rvcnk+CiAgICA8cmRmOlNlcT4KICAgICA8cmRmOmxpCiAgICAgIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiCiAgICAgIHN0RXZ0OmNoYW5nZWQ9Ii8iCiAgICAgIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6OWIxMWU5OWQtYmVmNi00NGY1LThmNzctZjkzYzEyYjEzZTQyIgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJHaW1wIDIuMTAgKExpbnV4KSIKICAgICAgc3RFdnQ6d2hlbj0iMjAyMS0wNC0yMVQxMDowMDowMC0wNDowMCIvPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo2OGRjYjU5Mi04OGZmLTRjYTgtOGM5Zi03MWNhMGMxMmM2ZDciCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoTGludXgpIgogICAgICBzdEV2dDp3aGVuPSIyMDIxLTA5LTIxVDA5OjU2OjA1LTA0OjAwIi8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFj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'

$IconStream = [System.IO.MemoryStream][System.Convert]::FromBase64String($Base64Icon)
$IconBMP = [System.Drawing.Bitmap][System.Drawing.Image]::FromStream($IconStream)
$form = New-Object System.Windows.Forms.Form
$form.Text = 'Test GUI'
$form.Size = '640, 480'
$form.FormBorderStyle='FixedToolWindow'
$form.StartPosition='CenterScreen'
$form.BackColor = [Drawing.Color]::Green

$image=New-Object Windows.Forms.PictureBox
$image.Size='432,191'
$image.Image = $IconBMP
$image.Location='415,350'


$combobox1 = New-Object 'System.Windows.Forms.ComboBox'
$combobox1_SelectedIndexChanged = {
    $script:var = $combobox1.SelectedItem
    Show-BalloonTip -Text  $combobox1.SelectedItem
    #$form.Close()
    }

    
    #add array of items
    [void]$combobox1.Items.Addrange(1 .. 10)
    
    #add single item
    #[void]$combobox1.Items.Add('Single Item')
    
    $combobox1.Location = '45, 25'
    $combobox1.Size = '187, 21'
    $combobox1.add_SelectedIndexChanged($combobox1_SelectedIndexChanged)
    
    write-output $var


$form.controls.add($image)
$form.Controls.Add($combobox1)
$form.Add_Shown({$form.Activate()})
[void]$form.ShowDialog()